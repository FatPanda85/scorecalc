<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>æ´»å‹•ç©åˆ†è©¦ç®—</title>
<style>
  body {
    font-family: "Microsoft JhengHei", sans-serif;
    margin: 0;
    background: #f9fafb;
  }
  header {
    background: #2563eb;
    color: white;
    text-align: center;
    padding: 12px 0;
    font-size: 20px;
    font-weight: bold;
  }
  .tabs {
    display: flex;
    overflow-x: auto;
    background: #1e40af;
  }
  .tabs button {
    flex: 1;
    padding: 10px;
    border: none;
    background: #1e40af;
    color: white;
    font-size: 14px;
    cursor: pointer;
    min-width: 100px;
  }
  .tabs button.active {
    background: #3b82f6;
  }
  .tab-content {
    display: none;
    padding: 10px;
  }
  .tab-content.active {
    display: block;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 8px;
  }
  th, td {
    border: 1px solid #ddd;
    padding: 6px;
    text-align: center;
  }
  th {
    background: #f1f5f9;
  }
  .total-section {
    margin-top: 10px;
    background: #eef2ff;
    padding: 8px;
    border-radius: 8px;
  }
  .btn-reset {
    background: #ef4444;
    color: white;
    border: none;
    padding: 6px 10px;
    border-radius: 6px;
    cursor: pointer;
    margin-top: 5px;
  }
  .btn-reset:hover {
    background: #dc2626;
  }
</style>
</head>
<body>

<header>æ´»å‹•ç©åˆ†è©¦ç®—</header>
<div class="tabs" id="tabs"></div>
<div id="tabContainer"></div>

<script>
// === ğŸ§­ æ´»å‹•è³‡æ–™è¨­å®šå€ ===
// æ¯å€‹æ´»å‹•å¯ä»¥ç¨ç«‹è¨­å®šåç¨±ã€è£å‚™èˆ‡é“å…·
const activitiesData = [
  {
    name: "ç¬¬ä¸€æ¬¡è»å‚™ç«¶æ¼”",
    equips: [
      ["è‰¯å¥½", 1125], ["è‰¯å¥½1æ˜Ÿ", 1875],
      ["ç¨€æœ‰", 3000], ["ç¨€æœ‰1æ˜Ÿ", 4500],
      ["å²è©©", 3230], ["å²è©©T1", 3440],
      ["å‚³èªª", 6250], ["ç¥è©±", 2600]
    ],
    items: [
      ["ç«æ™¶", 100],
      ["ç¨€æœ‰è‹±é›„ç¢ç‰‡", 15],
      ["å²è©©è‹±é›„ç¢ç‰‡", 50],
      ["å‚³èªªè‹±é›„ç¢ç‰‡", 125],
      ["åŠ é€Ÿ-å»ºé€ ", 1],
      ["åŠ é€Ÿ-ç ”ç©¶", 1],
      ["åŠ é€Ÿ-è¨“ç·´/æ™‰å‡", 1]
    ]
  },
  {
    name: "ç¬¬ä¸€æ¬¡å£«å®˜è¨ˆç•«",
    equips: [
      ["æ™®é€š", 500], ["è‰¯å¥½", 1200], ["ç¨€æœ‰", 2400], ["å²è©©", 3600]
    ],
    items: [
      ["å£«å®˜å¾½ç« ", 200],
      ["ç«æ™¶", 100],
      ["å‚³èªªç¢ç‰‡", 125]
    ]
  },
  {
    name: "ç¬¬äºŒæ¬¡è»å‚™ç«¶æ¼”",
    equips: [
      ["ç¨€æœ‰", 3000], ["å²è©©", 3230], ["å‚³èªª", 6250], ["ç¥è©±", 2600]
    ],
    items: [
      ["ç«æ™¶", 100],
      ["åŠ é€Ÿ-å»ºé€ ", 1],
      ["åŠ é€Ÿ-ç ”ç©¶", 1],
      ["åŠ é€Ÿ-è¨“ç·´/æ™‰å‡", 1]
    ]
  },
  {
    name: "ç¬¬äºŒæ¬¡å£«å®˜è¨ˆç•«",
    equips: [
      ["æ–°å…µè£å‚™", 900],
      ["æ™®é€šè£å‚™", 1500],
      ["ç²¾è‰¯è£å‚™", 2700]
    ],
    items: [
      ["è¨“ç·´ä»¤", 10],
      ["ç ”ç©¶ä»¤", 20],
      ["æˆ°åŠŸä»¤", 30]
    ]
  }
];

// === å‹•æ…‹å»ºç«‹é é¢ ===
const tabsDiv = document.getElementById("tabs");
const tabContainer = document.getElementById("tabContainer");

activitiesData.forEach((activity, idx) => {
  const id = idx + 1;
  const { name, equips, items } = activity;

  // å»ºç«‹åˆ†é æŒ‰éˆ•
  const btn = document.createElement("button");
  btn.textContent = name;
  btn.onclick = () => switchTab(id);
  if (id === 1) btn.classList.add("active");
  tabsDiv.appendChild(btn);

  // å»ºç«‹åˆ†é å…§å®¹
  const div = document.createElement("div");
  div.id = "tab" + id;
  div.className = "tab-content" + (id === 1 ? " active" : "");

  // å…§å®¹ HTML
  div.innerHTML = `
    <h2>${name}</h2>
    <div class="total-section">
      <label>ç›®æ¨™ç©åˆ†ï¼š</label>
      <input type="number" id="target${id}" placeholder="è¼¸å…¥ç›®æ¨™ç©åˆ†" />
    </div>
    <h3>è£å‚™é¸é …ï¼ˆÃ—3å€ç©åˆ†ï¼‰</h3>
    <table>
      <tr><th>è£å‚™</th><th>é¸æ“‡</th><th>ç©åˆ†</th></tr>
      ${[1,2,3,4].map(i => `
        <tr>
          <td>è£å‚™${i}</td>
          <td>
            <select class="equip" data-tab="${id}">
              <option value="0">è«‹é¸æ“‡è£å‚™</option>
              ${equips.map(([ename, score]) =>
                `<option value="${score}">${ename} (${score})</option>`).join('')}
            </select>
          </td>
          <td class="equip-total">0</td>
        </tr>`).join("")}
    </table>

    <h3>é“å…·</h3>
    <table>
      <tr><th>é“å…·åç¨±</th><th>æ•¸é‡</th><th>ç©åˆ†</th></tr>
      ${items.map(([iname, score]) => `
        <tr>
          <td>${iname}</td>
          <td><input type="number" class="qty" data-tab="${id}" data-score="${score}" value="0" min="0"></td>
          <td class="subtotal">0</td>
        </tr>`).join("")}
    </table>

    <div class="total-section">
      <label>ç¸½ç©åˆ†ï¼š</label><span id="total${id}">0</span><br/>
      <label>å·®é¡ç©åˆ†ï¼š</label><span id="diff${id}">0</span><br/>
      <button class="btn-reset" onclick="resetTab(${id})">å…¨éƒ¨é‡ç½®</button>
    </div>
  `;
  tabContainer.appendChild(div);
});

// === åˆ†é åˆ‡æ› ===
function switchTab(n) {
  document.querySelectorAll(".tabs button").forEach((btn, i) => {
    btn.classList.toggle("active", i === n - 1);
  });
  document.querySelectorAll(".tab-content").forEach((div, i) => {
    div.classList.toggle("active", i === n - 1);
  });
}

// === å³æ™‚è¨ˆç®—ç©åˆ† ===
document.addEventListener("input", (e) => {
  const tab = e.target.closest(".tab-content");
  if (!tab) return;
  const tabId = tab.id.replace("tab", "");
  updateTab(tabId);
});

function updateTab(tabId) {
  let total = 0;

  // è£å‚™ç©åˆ†
  document.querySelectorAll(`#tab${tabId} .equip`).forEach(sel => {
    const val = Number(sel.value);
    const subtotal = val * 3;
    sel.closest("tr").querySelector(".equip-total").textContent = subtotal;
    total += subtotal;
  });

  // é“å…·ç©åˆ†
  document.querySelectorAll(`#tab${tabId} .qty`).forEach(input => {
    const qty = Number(input.value) || 0;
    const score = Number(input.dataset.score);
    const subtotal = qty * score;
    input.closest("tr").querySelector(".subtotal").textContent = subtotal;
    total += subtotal;
  });

  document.getElementById(`total${tabId}`).textContent = total;

  const target = Number(document.getElementById(`target${tabId}`).value) || 0;
  const diff = Math.max(target - total, 0);
  document.getElementById(`diff${tabId}`).textContent = diff;
}

// === é‡ç½®åŠŸèƒ½ ===
function resetTab(id) {
  document.querySelectorAll(`#tab${id} .qty`).forEach(input => input.value = 0);
  document.querySelectorAll(`#tab${id} .subtotal, #tab${id} .equip-total`).forEach(td => td.textContent = 0);
  document.querySelectorAll(`#tab${id} .equip`).forEach(sel => sel.value = 0);
  document.getElementById(`target${id}`).value = "";
  document.getElementById(`total${id}`).textContent = "0";
  document.getElementById(`diff${id}`).textContent = "0";
}
</script>

</body>
</html>
